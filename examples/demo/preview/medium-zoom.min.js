/*
 * medium-zoom v0.3.0
 * Medium zoom on your images in vanilla JavaScript
 * Copyright 2018 Francois Chalifour
 * https://github.com/francoischalifour/medium-zoom
 * MIT License
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.mediumZoom=t()}(this,function(){"use strict";var e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},t=["IMG"],o=[27,81],n=function(e){return t.indexOf(e.tagName)>-1},i=function(e){return e.naturalWidth!==e.width},r=function(e){return e&&1===e.nodeType},d=function(d){var l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},m=l.margin,c=void 0===m?0:m,s=l.background,u=void 0===s?"#fff":s,p=l.scrollOffset,f=void 0===p?48:p,v=l.metaClick,g=void 0===v||v,h=l.container,y=l.template,z=function(){if(j.original){var e,t,o,n,i,d,l,m,c;if(j.original.dispatchEvent(new a("show")),M=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,q=!0,j.zoomed=(e=j.original,t=e.getBoundingClientRect(),o=t.top,n=t.left,i=t.width,d=t.height,l=e.cloneNode(),m=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,c=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0,l.removeAttribute("id"),l.style.position="absolute",l.style.top=o+m+"px",l.style.left=n+c+"px",l.style.width=i+"px",l.style.height=d+"px",l.style.transform="",l),document.body.appendChild(S),x.template){var s=r(x.template)?x.template:document.querySelector(x.template);j.template=document.createElement("div"),j.template.appendChild(s.content.cloneNode(!0)),document.body.appendChild(j.template)}if(document.body.appendChild(j.zoomed),requestAnimationFrame(function(){document.body.classList.add("medium-zoom--open")}),j.original.style.visibility="hidden",j.zoomed.classList.add("medium-zoom-image--open"),j.zoomed.addEventListener("click",b),j.zoomed.addEventListener("transitionend",L),j.original.getAttribute("data-zoom-target")){j.zoomedHd=j.zoomed.cloneNode(),j.zoomedHd.src=j.zoomed.getAttribute("data-zoom-target"),j.zoomedHd.onerror=function(){clearInterval(u),console.error("Unable to reach the zoom image target "+j.zoomedHd.src),j.zoomedHd=null,O()};var u=setInterval(function(){j.zoomedHd.naturalWidth&&(clearInterval(u),j.zoomedHd.classList.add("medium-zoom-image--open"),j.zoomedHd.addEventListener("click",b),document.body.appendChild(j.zoomedHd),O())},10)}else O()}},b=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=function(){!q&&j.original&&(j.original.dispatchEvent(new a("hide")),q=!0,document.body.classList.remove("medium-zoom--open"),j.zoomed.style.transform="",j.zoomedHd&&(j.zoomedHd.style.transform="",j.zoomedHd.removeEventListener("click",e)),j.template&&(j.template.style.transition="opacity 150ms",j.template.style.opacity=0),j.zoomed.removeEventListener("click",e),j.zoomed.addEventListener("transitionend",C))};t>0?setTimeout(o,t):o()},w=function(e){e&&e.target?(j.original=e.target,z()):j.original?b():(j.original=N[0],z())},E=function(e){if((e.metaKey||e.ctrlKey)&&x.metaClick)return window.open(e.target.getAttribute("data-original")||e.target.parentNode.href||e.target.src,"_blank");e.preventDefault(),w(e)},L=function e(){q=!1,j.zoomed.removeEventListener("transitionend",e),j.original.dispatchEvent(new a("shown"))},C=function e(){j.original&&(j.original.style.visibility="",document.body.removeChild(j.zoomed),j.zoomedHd&&document.body.removeChild(j.zoomedHd),document.body.removeChild(S),j.zoomed.classList.remove("medium-zoom-image--open"),j.template&&document.body.removeChild(j.template),q=!1,j.zoomed.removeEventListener("transitionend",e),j.original.dispatchEvent(new a("hidden")),j.original=null,j.zoomed=null,j.zoomedHd=null,j.template=null)},H=function(){if(!q&&j.original){var e=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;Math.abs(M-e)>x.scrollOffset&&b(150)}},k=function(e){o.indexOf(e.keyCode||e.which)>-1&&b()},O=function(){if(j.original){var t={width:window.innerWidth,height:window.innerHeight,left:0,top:0,right:0,bottom:0},o=void 0,n=void 0;if(x.container)if(x.container instanceof Object)e(t,x.container),o=t.width-t.left-t.right-2*x.margin,n=t.height-t.top-t.bottom-2*x.margin;else{var i=(r(x.container)?x.container:document.querySelector(x.container)).getBoundingClientRect(),d=i.width,a=i.height,l=i.left,m=i.top;e(t,{width:d,height:a,left:l,top:m})}o=o||t.width-2*x.margin,n=n||t.height-2*x.margin;var c=j.zoomedHd||j.original,s=c.naturalWidth,u=void 0===s?o:s,p=c.naturalHeight,f=void 0===p?n:p,v=c.getBoundingClientRect(),g=v.top,h=v.left,y=v.width,z=v.height,b=Math.min(u,o)/y,w=Math.min(f,n)/z,E=Math.min(b,w)||1,L="scale("+E+") translate3d("+((o-y)/2-h+x.margin+t.left)/E+"px, "+((n-z)/2-g+x.margin+t.top)/E+"px, 0)";j.zoomed.style.transform=L,j.zoomedHd&&(j.zoomedHd.style.transform=L)}},x={margin:c,background:u,scrollOffset:f,metaClick:g,container:h,template:y};d instanceof Object&&e(x,d);var T,A,N=function(e){try{return Array.isArray(e)?e.filter(n):(o=e,NodeList.prototype.isPrototypeOf(o)||HTMLCollection.prototype.isPrototypeOf(o)?Array.apply(null,e).filter(n):r(e)?[e].filter(n):"string"==typeof e?Array.apply(null,document.querySelectorAll(e)).filter(n):Array.apply(null,document.querySelectorAll(t.map(function(e){return e.toLowerCase()}).join(","))).filter(i))}catch(e){throw new TypeError("The provided selector is invalid.\nExpects a CSS selector, a Node element, a NodeList, an HTMLCollection or an array.\nSee: https://github.com/francoischalifour/medium-zoom")}var o}(d),S=(T=x.background,(A=document.createElement("div")).classList.add("medium-zoom-overlay"),A.style.backgroundColor=T,A),j={original:null,zoomed:null,zoomedHd:null,template:null},M=0,q=!1;return N.forEach(function(e){e.classList.add("medium-zoom-image"),e.addEventListener("click",E)}),S.addEventListener("click",b),document.addEventListener("scroll",H),document.addEventListener("keyup",k),window.addEventListener("resize",b),{show:w,hide:b,toggle:w,update:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.background&&(S.style.backgroundColor=t.background),t.container&&t.container instanceof Object&&(t.container=e({},x.container,t.container)),e(x,t)},addEventListeners:function(e,t){N.forEach(function(o){o.addEventListener(e,t)})},detach:function(){var e=function e(){var t=new a("detach");N.forEach(function(e){e.classList.remove("medium-zoom-image"),e.removeEventListener("click",E),e.dispatchEvent(t)}),N.splice(0,N.length),S.removeEventListener("click",b),document.removeEventListener("scroll",H),document.removeEventListener("keyup",k),window.removeEventListener("resize",b),j.zoomed&&j.zoomed.removeEventListener("transitionend",e)};j.zoomed?(b(),j.zoomed.addEventListener("transitionend",requestAnimationFrame(e))):e()},images:N,options:x}},a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{bubbles:!1,cancelable:!1,detail:void 0};if("function"==typeof window.CustomEvent)return new CustomEvent(e,t);var o=document.createEvent("CustomEvent");return o.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),o},l=Object.freeze({default:d});return function(e,t){void 0===t&&(t={});var o=t.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===o&&n.firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}(".medium-zoom-overlay{position:fixed;top:0;right:0;bottom:0;left:0;opacity:0;transition:opacity .3s;will-change:opacity}.medium-zoom--open .medium-zoom-overlay{cursor:pointer;cursor:zoom-out;opacity:1}.medium-zoom-image{cursor:pointer;cursor:zoom-in;transition:transform .3s}.medium-zoom-image--open{position:relative;cursor:pointer;cursor:zoom-out;will-change:transform}",{}),l&&d||l});
